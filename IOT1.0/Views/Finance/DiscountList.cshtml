@using DataProvider.Models
@using DataProvider.Paging
@{
    ViewBag.Title = "优惠管理";
}
@model ButtonListViewModel
@section styles{
    <style type="text/css">
    </style>
}
<div class="wrapper wrapper-content  animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <!-- 数据显示区 -->
                <div class="ibox-content">
                    <!-- 功能操作区 -->
                    @using (Html.BeginForm(null, null, FormMethod.Post, new { id = "frmQuery", @class = "form-horizontal form-horizontal" }))
                    {
                        <div class="form-group">
                            <div class="col-sm-2">
                                <label class="control-label">优惠名称：</label>
                            </div>
                            <div class="col-sm-4">
                                <input type="text" class="form-control input-sm">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-4">
                                <div class="btn-group">
                                    <button class="btn btn-primary btn-sm" type="button" onclick="javascript:modify();"><i class="fa fa-plus-square"></i> 新增</button>
                                </div>
                            </div>
                            <div class="col-sm-8 project-actions">
                                <button type="submit" id="submit" class="btn btn-w-m btn-primary btn-sm">查&nbsp;&nbsp;&nbsp;&nbsp;询</button>
                            </div>
                        </div>
                    }
                    <!-- 数据列表 -->
                    <table class="table table-striped table-bordered table-hover dataTables-example">
                        <thead>
                            <tr>
                                <th>优惠名称</th>
                                <th>有效期</th>
                                <th>优惠方式</th>
                                <th>折扣</th>
                                <th>减免</th>
                                <th>满足条件</th>
                                <th>是否启用</th>
                                <th>创建日期</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <!-- 循环数据 -->
                        <tbody>
                            <!-- 测试数据 -->
                            <tr>
                                <td>老学员优惠</td>
                                <td>2017-01-03～2017-10-10</td>
                                <td>减免</td>
                                <td>-</td>
                                <td>100</td>
                                <td>老学员报名</td>
                                <td>是</td>
                                <td>2017-09-03</td>
                                <td>
                                    <a href="javascript:" class="btn btn-primary btn-xs" type="button"><i class="fa fa-edit"></i> 编辑</a>
                                    <a href="javascript:" class="btn btn-primary btn-xs" type="button"><i class="fa fa-adjust"></i> 停用</a>
                                </td>
                            </tr>
                            <tr>
                                <td>新春优惠</td>
                                <td>2017-02-03～2017-10-10</td>
                                <td>折扣</td>
                                <td>9.0</td>
                                <td>-</td>
                                <td>新春内有效</td>
                                <td>是</td>
                                <td>2017-01-03</td>
                                <td>
                                    <a href="javascript:" class="btn btn-primary btn-xs" type="button"><i class="fa fa-edit"></i> 编辑</a>
                                    <a href="javascript:" class="btn btn-primary btn-xs" type="button"><i class="fa fa-adjust"></i> 停用</a>
                                </td>
                            </tr>
                            <!-- 测试数据 -->
                        </tbody>

                    </table>
                    @if (Model != null && Model.buttonlist.TotalPageCount > 0)
                    {
                        <div class="row">
                            <div class="dataTables_info col-sm-6">每页显示 @Model.search.PageSize 条，共<span>@Model.buttonlist.TotalItemCount</span>条数据</div>
                            <div class="col-sm-6">

                                @Html.Pager(Model.buttonlist, new PagerOptions(), "", new RouteValueDictionary {
                                   { "pageindex",  Model.search.CurrentPage },
                                   { "pagesize", ViewBag.PageSize }
                               }, null)
                            </div>

                        </div>
                    }
                </div>
            </div>
        </div>

    </div>
</div>


@*弹出层，新增优惠*@
    <div class="ibox float-e-margins" id="discount" style="display:none">
        <div class="ibox-content">
            <form class="form-horizontal">
                <div class="form-group">
                    <label class="col-sm-3 control-label">优惠名称：</label>
                    <div class="col-sm-8">
                        <input type="text" placeholder="请输入优惠名称..." class="form-control" id="ApName">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">优惠方式：</label>
                    <div class="col-sm-8">
                        <select data-placeholder="请选择优惠方式..." class="form-control" style="width:100%" id="discounttype">
                            <option value="">请选择...</option>
                            <option value="1">已折扣方式</option>
                            <option value="2">已减免金额方式</option>
                        </select>
                    </div> 
                </div>
                <div class="form-group" id="zk">
                    <label class="col-sm-3 control-label">折扣率：</label>
                    <div class="col-sm-8">
                        <input type="text" placeholder="请输入折扣率" class="form-control" id="APLinkMan">
                    </div>
                </div>
                <div class="form-group" id="jm">
                    <label class="col-sm-3 control-label">减免金额：</label>
                    <div class="col-sm-8">
                        <input type="text" placeholder="请输入减免金额数" class="form-control" id="APGrade">
                    </div>
                </div>
                <div class="form-group">          
                        <label class="col-sm-3 control-label">有效期范围:</label>
                    <div class="input-daterange">
                        <div class="col-sm-4">
                            <div class="input-group date">
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                <input type="text" class="form-control input-sm" value="2014-11-11">
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="input-group date">
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                <input type="text" class="form-control input-sm" value="2014-11-11">
                            </div>

                        </div>

                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">备注：</label>
                    <div class="col-sm-8">
                        <textarea placeholder="备注" class="form-control" id="APRemark"></textarea>
                    </div>
                </div>
            </form>
        </div>
</div>
<script type="text/javascript">
    //新增或编辑优惠
    function modify(id) {
        cleanData("discount");//清空数据
        layer.open({
            type: 1,
            title: "<h3 class='ibox-title'>优惠</h3>",
            area: ['680px', '400px'],
            content: $('#discount'),
            btn: ['保存', '取消'],
            yes: function () {
                save(id);
            },
            cancel: function (index) {
                layer.close(index);
            }
        });

        if (id) {//提供存着ID就是修改，则加载数据，不然打开空页面
            var loadindex = layer.load();
            loaddetail(id, loadindex)
        }
    }
    $("#discounttype").change(function () {
        changeDiscountType();
    });


    function changeDiscountType() {
        if ("1" == $("#discounttype").val()) {
            $("#zk").show();
            $("#jm").hide();
        }
        else {
            $("#zk").hide();
            $("#jm").show();
        }
    }
</script>